$.ui.dialog.prototype._focusTabbable=function(){};var CPopup=function(){this.caoPopup={};this.getConfig=function(e,t){if(!e)e=Math.random().toString(36).substr(4);if(!t)t="layer";var n={type:t,tag:e,contentTag:null,persistent:false,forceRefresh:false,title:null,buttons:{},width:400,height:210,maxHeight:800,maxWidth:1400,minHeight:30,minWidth:60,position:{},autoOpen:true,modal:true,closeOnEscape:true,closeText:"",dialogClass:"",draggable:true,resizable:true,hide:{effect:"fade",delay:0,duration:100},show:{effect:"fade",delay:0,duration:250},close:function(){goPopup.remove(this)}};return n};this.remove=function(e,t){if(typeof e==="string")e="#"+e;if(!$(e).hasClass("ui-dialog-content")){return false}var n=$(e).attr("id");$(e).dialog("close");$(e).closest(".ui-dialog").hide();if(t===true||!$(e).dialog("option","persistent")){$(e).dialog("destroy");delete this.caoPopup[n];$(e).remove();console.log("removed/destroyed "+n);return true}if($(e).dialog("option","draggable")){this.caoPopup[n].position=$(e).dialog("option","position")}return true};this.removeAll=function(e){$.map(this.caoPopup,function(t,n){goPopup.remove(t.tag,e)});this.caoPopup={}};this.removeByType=function(e,t){if(!e)return false;$.map(this.caoPopup,function(n,r){console.log("remove by type:  popup - ["+r+"] "+n.type+" ? param -"+e);if(n.type==e){goPopup.remove(n.tag,t)}});return true};this.removeLastByType=function(e,t){if(!e)return false;var n="";$.map(this.caoPopup,function(t,r){if(t.type==e){n=t.tag;return true}});console.log("removeLastByType --> tag to remove: "+n);this.remove(n,t);return true};this.create=function(e,t,n){if(!e)return"";if(!t===undefined||t===null)t=" &nbsp; ";this.caoPopup[e.tag]=e;if(e.title===undefined||e.title===null||e.title===false)e.title="";if(!n)$('<div class="popupMessage hidden" id="'+e.tag+'"></div>').html(t).appendTo("body");$("#"+e.tag).dialog(e);return e.tag};this.getActive=function(e){var t=null;if(e){switch(e){case"layer":t=$(".ui-dialog.popup_layer:visible:last");break;case"notice":t=$(".ui-dialog.popup_layer:visible:last");break;case"message":t=$(".ui-dialog.popup_message:visible:last");break;default:t=$(".ui-dialog:visible:last");break}}if(!t)return"";var n=$("div.ui-dialog-content",t).attr("id");if(!n){return""}var r=$("#"+n).dialog("isOpen");if(!r||r=="undefined")return"";return n};this.removeActive=function(e){var t=this.getActive(e);if(!t){console.log("removeActive --> no active layer --> removeLastByType("+e+")");console.log(this.caoPopup);return this.removeLastByType(e)}console.log("removeActive -->"+t);return this.remove(t)};this.addButton=function(psLabel,psAction,pbKeepPopup){if(pbKeepPopup){var oButton={text:psLabel,click:function(){eval(psAction)}}}else{var oButton={text:psLabel,click:function(){eval(psAction);$(this).dialog("close")}}}return oButton};this.changeConfig=function(e,t,n){if(!this.caoPopup[e])return false;this.caoPopup[e][t]=n;$("#"+e).dialog("option",t,n);return true};this.setPopupMessage=function(e,t,n,r,i,s){var o=this.getConfig("","msg");if(t)o.modal=true;if(s)o.dialogClass=s;if(n===undefined||n===null||n===false){o.dialogClass+=" noTitle";o.buttons=[this.addButton("close")]}else o.title=n;if(r)o.width=r;if(i)o.height=i;o.dialogClass+=" popup_message";return this.create(o,e)};this.setErrorMessage=function(e,t,n,r,i){e=e.split("\n").join("<br />");return this.setPopupMessage(e,t,n,r,i,"ui-state-error")};this.setPopupConfirm=function(psMessage,psConfirmedAction,psRefusedAction,psConfirmedBtn,psRefusedBtn,psTitle,pnWidth,pnHeight){var oPopup=this.getConfig("","confirm");oPopup.modal=true;if(pnWidth)oPopup.width=pnWidth;if(pnHeight)oPopup.height=pnHeight;if(psTitle)oPopup.title=psTitle;else oPopup.dialogClass="noTitle";if(!psConfirmedBtn)psConfirmedBtn="Ok";if(!psRefusedBtn)psRefusedBtn="Cancel";oPopup.dialogClass+=" popup_confirm";oPopup.buttons=[{text:psConfirmedBtn,click:function(){eval(psConfirmedAction);goPopup.remove(this)}},{text:psRefusedBtn,click:function(){eval(psRefusedAction);goPopup.remove(this)}}];oPopup.dialogClass+=" popup_message";return this.create(oPopup,psMessage)};this.setNotice=function(psContent,paAction,pbAnimation,pbModal,pnWidth,pnHeight,psClass){var oPopup=this.getConfig("","notice");oPopup.position={at:"right bottom"};oPopup.closeOnEscape=true;oPopup.dialogClass="notifierPopup popup_notice";oPopup.draggable=false;oPopup.resizable=false;if(pbModal===true)oPopup.modal=true;else oPopup.modal=false;if(pbAnimation!==false)oPopup.dialogClass+=" notifierPopupAnimation";if(pnWidth)oPopup.width=pnWidth;else oPopup.width=350;if(pnHeight)oPopup.height=pnHeight;else oPopup.height=60;if(psClass)oPopup.dialogClass+=" "+psClass;var sId=this.create(oPopup,psContent);if(!paAction)paAction={};if(!paAction.delay)paAction.delay=1e3;else paAction.delay=parseInt(paAction.delay)-500;if(paAction.timedUrl)paAction.url=paAction.timedUrl;if(paAction.callback)eval(paAction.callback);else{if(paAction.url){setTimeout("window.location.href = '"+paAction.url+"'; ",paAction.delay);setTimeout("window.location.reload(); ",paAction.delay+2500)}else setTimeout("goPopup.remove('"+sId+"'); ",paAction.delay+500)}return sId};this.setLayer=function(e,t,n,r,i,s,o){var u=this.getConfig(e,"layer");if(i)u.persistent=i;if(n&&n!="undefined")u.title=n;if(r!==false)u.modal=true;if(s)u.width=s;else u.width=800;if(o)u.height=o;else u.height=600;u.dialogClass+=" popup_layer";return this.setLayerByConfig(e,u,t)};this.setLayerByConfig=function(e,t,n){if(!e)e=t.tag;if(this.restorePersistentLayer(t))return true;t.type="layer";if(t.title===undefined||t.title===null||t.title===false)t.title=null;if(!t.buttons&&t.title===null){t.title=""}return this.create(t,n)};this.setLayerFromTag=function(e){var t;if(typeof e=="object")t=$(e);else t=$("#"+e);var n=$(t).data();if(n.length<=0)return false;var r=this.getConfig($(t).attr("id"),"layer");$.map(n,function(e,t){if(t=="class")t="dialogClass";r[t]=e});r.dialogClass+=" popup_layer";if(this.restorePersistentLayer(r))return true;return this.create(r,$(t).html(),true)};this.setLayerFromAjax=function(e,t,n,r,i,s,o,u){var a=null;if(!e){a=this.getConfig("","layer");a.width=800;a.height=600;a.modal=true;a.autoOpen=false}else{a=e;a.type="layer"}if(this.restorePersistentLayer(e))return true;a.dialogClass+=" popup_layer";this.setLayerByConfig(a.tag,a,'<span class="popupLoading"><span class="popupLoadingImage" >&nbsp;</span><span class="popupLoadingText" > Loading ... </span></span>');if(!o)o="";o+=' goPopup.setLayer("'+a.tag+'");';AjaxRequest(t,n,r,a.tag,i,s,o,u);return a.tag};this.restorePersistentLayer=function(e){if(e)var t=this.caoPopup[e.tag];else var t=false;if(t){if(e.forceRefresh&&(!e.contentTag||e.contentTag!=t.contentTag)){return""}$("#"+e.tag).dialog(this.caoPopup[e.tag]).dialog("open");return e.tag}return""}}